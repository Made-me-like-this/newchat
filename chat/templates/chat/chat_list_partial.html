{% load static %}
<div class="chat-list-header">
    <div class="flex justify-between items-center">
        <h2>Your Chats</h2>
        <a href="{% url 'chat:create_chat' %}" class="new-chat-button">
            <i class="fas fa-plus"></i>
            New Chat
        </a>
    </div>
</div>
<ul class="chat-list">
    {% for chat in chats %}
    <li class="chat-list-item {% if chat.id == active_chat %}active{% endif %}">
        <a href="{% url 'chat:chat_detail' chat.id %}" class="flex items-center">
            <div class="chat-avatar">
                {% with other_user=chat.participants.exclude.id|first %}
                <img src="{{ other_user.avatar.url|default:'/static/images/default-avatar.png' }}"
                    alt="{{ other_user.username }}">
            </div>
            <div class="chat-info">
                <h3>{{ other_user.username }}</h3>
                {% endwith %}
                <p>{{ chat.messages.last.content|default:"Start a conversation!"|truncatechars:30 }}</p>
            </div>
        </a>
    </li>
    {% empty %}
    <li class="text-center text-gray-500 p-4">
        No chats yet. Start a conversation!
    </li>
    {% endfor %}
</ul>